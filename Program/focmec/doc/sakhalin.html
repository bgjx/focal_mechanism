<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>FOCMEC: Sakhalin Island Event</TITLE>
</head>
<BODY BGCOLOR="#ffffff">
<table width="850" align = "center" BORDER="0" Cellpadding="3">
<tr>
<td>

<h2 align="center"><i>FOCMEC: P</i> &amp; <i>S</i> polarities and amplitude ratios</h2>

<p>This page supplements the discussion in Section 4.2 of the <a href="./focmec_manual.pdf"><i>FOCMEC</i> manual</a>: the application of the <i>FOCMEC</i> package to find the focal mechanism for the 12 May 1990 M=6.5 z=611 km  Sakhalin Island earthquake using two data sets: (1) <i>P</i> and <i>S</i> polarities plus amplitude ratios from eight broadband stations, and (2) 190 <i>P</i>-wave polarities.  The discussion is a revisit of my earlier study.  (My 1990 study contributed to the realization that the vertical component at station HRV and all three components at station KIP had reversed polarities.  The reversals at KIP was not realized at the time of the 1990 presentation, as can be seen from <a href="./snoke-esssa90.pdf" target="_blank">my 1990 ESSA abstract</a>.)  Directory <i>./focmec/sample_runs/sakhalin</i> includes drivers and input, files for this update of that study.</p>

<p>The 1990 analysis of the eight broadband stations used the <i>JB</i> velocity model and traveltime tables to calculate take-off angles and, for the amplitude ratios, the free-surface corrections. For the runs done for the 2009 edition of this package, the <i>iasp91</i> velocity model and traveltime tables was used to allow demonstrations of programs <i>ratio_prep</i> and <i>focmec_prep</i> described below.  For the 2017 version, I used the iaspei-tau package to create a model I call <i>nocrust</i> that is model <i>ak135</i> except that the crustal layers have the same values as the uppermost mantle (because the wavelengths of the direct arrivas are several seconds long so that the free-surface correction should not be based on the crustal velocities).  Changing the model used has very little effect for this study; the differences in take-off angle are never more than a couple of degrees, which leads to negligible differences in the <i>focmec</i> solutions. </p>

<p>The driver files for programs <i>focmec</i> and <i>focplt</i> are Unix csh scripts that include comments.  (The programs can be run interactively without using scripts, but using the scripts allows quick editing to fine-tune runs.).</p>
 
<p>Two programs are used in preparing the <i>focmec</i> input data file for the Sakhalin Island event from the broadband stations.  Program <i>ratio_prep</i>, takes as its input a hypocenter plus a list of stations for which it calculates epicentral distances and azimuths.  Using the <i>nocrust</i> velocity model and traveltime tables, it calculates take-off angles and arrival times for both <i>P</i> and <i>S</i>.  The output file from <i>ratio_prep</i> is then read by the companion program <i>focmec_prep</i>.  That file has one line containing the data for each polarity and/or ratio.  For polarities, the program reads in the station name and the polarity key (see Appendix A in the manual).  For a ratio, the line has the station, the ratio key, the key for the polarity of the numerator (not used, but displayed in the output listings), and either two or six numbers separated by commas &mdash; the numerator and denominator amplitudes plus (if used) attenuation data in the form Q<sub>num</sub>, Q<sub>den</sub>, freq<sub>num</sub>, freq<sub>den</sub>, where the &ldquo;freq&rdquo; terms are the frequencies at which the amplitudes were determined.  The output of <i>focmec_prep</i> is a file that can be used as the input file for program <i>focmec</i>.  (In the 2017 version, the P/S focus velocity ratio read from a file rather than entered manually, so it is in input lines for ratios.  Prior to July 2008, program <i>ratio_prep</i> was named <i>fileprep</i>, and program <i>focmec_prep</i> was named <i>fmecprep</i>.)</p>

<p>If an amplitude for <i>SV</i> is used, <i>focmec_prep</i> assumes it is from the radial component.  If the <i>SV</i> amplitude was measured on the vertical, it must be converted to what it would be on the radial component.  That conversion factor is included in the output from program <i>focmec_prep</i> or can be found using program <i>freesurf</i>.</p>

<p>A change in the 2017 version of the package is my recommended method for calculating amplitudes.  See section 4.2.1 in the manual.  For teleseisms I now feel a Q correction is necessary, and my preference is to work with low-pass-filtered pulses that have been corrected to displacement.  See section 4.2.1 in the manual.</p>

<p>See <a href="../sample_runs/sakhalin/README.txt" target="_blank"><i>./focmec/sample_runs/sakhalin/README.txt</i></a> for instructions and information about the driver scripts.</p>

</td></tr></table>
</body>
</html>
