C+
	SUBROUTINE PROJKT(XOUT,YOUT,XIN,YIN,XON,YON,XSPAN,YSPAN,XOK,YOK)
C
C	Projects the OUT points onto the boundary "correctly".
C-
	LOGICAL XOK,YOK
	IF (XOK) THEN
	  IF (YOUT .LT. 0.0) THEN
	    YON = 0.0
	  ELSE
	    YON = YSPAN
	  END IF
	  XON = XOUT + (YON - YOUT)*(XIN-XOUT)/(YIN-YOUT)
	  RETURN
	END IF
	TANYX = (YIN - YOUT)/(XIN - XOUT)
	IF (YOK) THEN
	  IF (XOUT .LT. 0.0) THEN
	    XON = 0.0
	  ELSE
	    XON = XSPAN
	  END IF
	  YON = YOUT + (XON - XOUT)*TANYX
	  RETURN
	END IF
	IF (YOUT .LT. 0.0) THEN
	  YON = 0.0
	ELSE
	  YON = YSPAN
	END IF
	IF (XOUT .LT. 0.0) THEN
	  XON = 0.0
	ELSE
	  XON = XSPAN
	END IF
	COMPAR = (YON - YOUT)/(XON - XOUT)
	IF (ABS(TANYX/COMPAR) .GT. 1.0) THEN
	  YON = YOUT + (XON - XOUT)*TANYX
	ELSE
	  IF (ABS(TANYX/COMPAR) .LT. 1.0) THEN
	    XON = XOUT + (YON - YOUT)/TANYX
	  END IF
	END IF
	RETURN
	END
